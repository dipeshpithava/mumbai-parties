<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <title></title>

        <!-- bootstrap !-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" type="text/css" href="css/styles.css" />

        <style>
            
        </style>

    </head>
    <body class="bg">
        <div id="header" class="container pad0">
            <div class="menu-header">
                <div class="col-sm-2 col-xs-2">
                    <label onclick="go_to_search();"><span class="fa fa-chevron-left fa-2x angleleft"></span></label>
                </div>
                <div id="searchloc" class="col-sm-10 col-xs-10" style="padding: 6px 0px 0px 9px;">
                    <div id="searchopt" class="searchdec"></div>
                   <!--  <label onclick="direct_to_map();"><span class="fa fa-2x fa-search"></span></label>
 -->                    <button class="btn btn-sm btn-link" onclick="direct_to_map();"><span class="fa fa-2x fa-search"></span></button>
                </div>

             <!--    <div id="searchloc" class="col-sm-3 col-xs-3">
                    <button class="btn btn-sm btn-danger" onclick="direct_to_map();"><span class="fa fa-2x fa-search"></span></button>
                </div> -->
            </div>
        </div>
<!--         <div class="menu_sidebar">
            test <br>
            test <br>
            test <br>
            test <br>
        </div> -->
        <div id="login" class="login">
            <center>
            <!-- <span class="text-center logo">Mumbai <br>Parties</span> -->
                <div class="logincontainer">
                <div class="logo"><img src="/img/logo.png" class="img-reponsive"></div>
                    <div class="account-wall">
                    <div class="control-group">
                        <div class="input-group regform">
                          <span class="input-group-addon" id="basic-addon1"><i class="fa fa-user txtico"></i></span>
                          <input type="email" class="form-control" placeholder="username" aria-describedby="basic-addon1" data-validation-required-message="Please enter your email" id="email" required>
                        </div>
                        <div class="input-group regform">
                          <span class="input-group-addon" id="basic-addon1"><i class="fa fa-lock txtico"></i></span>
                          <input type="password" class="form-control" placeholder="password" aria-describedby="basic-addon1" data-validation-required-message="Please provide your password" id="password" required>
                        </div>
                        <p class="help-block" style=""></p>
                        <button onclick="return login();" class="btn btn-lg btn-danger btn-block btnsn" type="submit">
                            Sign In</button>

                        <button onclick="" class="btn btn-lg btn-primary btn-block btnfb" type="submit">
                            Sign In With <span> facebook</span></button>
                    </div>
                    <label class="latertxt"><p>NEVERMIND. I'LL SIGNUP LATER</p></label> 
                    <div class="row">
                        <div class="col-sm-6 col-xs-6"><label class="signotxt" onclick=""><p>Forgot your password?</p></label></div>
                        <div class="col-sm-6 col-xs-6"><label class="signotxt" onclick="goto_register();"><p>New here? Sign Up</p></label></div>    
                    </div>
                    </div>
                </div>
            </center>
        </div>
        <div id="register" class="register">
            <center>
                <div class="registercontainer">
              <div class="logo"><img src="/img/logo.png" class="img-reponsive"></div>
                    <div class="account-wall">
                        <div class="control-group">
                        <div class="input-group regform">
                          <span class="input-group-addon" id="basic-addon1"><i class="fa fa-user txtico"></i></span>
                          <input type="text" class="form-control" placeholder="First Name" aria-describedby="basic-addon1" data-validation-required-message="Please enter your name" id="fname" required>
                        </div>
                        <div class="input-group regform">
                          <span class="input-group-addon" id="basic-addon1"><i class="fa fa-user txtico"></i></span>
                          <input type="email" class="form-control" placeholder="Email" aria-describedby="basic-addon1" data-validation-required-message="Please enter your email" id="newemail" required>
                        </div>
                        <div class="input-group regform">
                          <span class="input-group-addon" id="basic-addon1"><i class="fa fa-lock txtico"></i></span>
                          <input type="password" class="form-control" placeholder="Password" aria-describedby="basic-addon1" data-validation-required-message="Please provide your password" id="newpassword" required>
                        </div>
                         <div class="input-group regform">
                          <span class="input-group-addon" id="basic-addon1"><i class="fa fa-lock txtico"></i></span>
                          <input type="password" class="form-control" placeholder="Confirm Password" aria-describedby="basic-addon1" data-validation-required-message="Please confirm your password" id="newcpassword" required>
                        </div>
                        <div class="input-group regform">
                          <span class="input-group-addon" id="basic-addon1"><i class="fa fa-user txtico"></i></span>
                          <input type="tel" class="form-control" placeholder="Phone Number" aria-describedby="basic-addon1" data-validation-required-message="Please enter your Phone Number" id="tel" required>
                        </div>
                        <p class="help-block" style=""></p>
                        <button onclick="return submit_data();" class="btn btn-lg btn-danger btn-block" type="submit">
                            Sign Up</button>
                    </div>
                    <label class="latertxt" onclick="go_to_login();"><p>Back To Login</p></label> 
                        </div>
                </div>
            </center>
        </div>               
        <div id="searchlocation" class="searchlocation">
            <center>
                <div class="searchbar">
                    <div id="divlocation">
                    </div>
                </div>
                <label id="searchentity" onclick="load_event_list();">
                    <button type="button" class="btn btn-lg btn-danger">Search Events</button>
                </label>
            </center>
        </div>
        <div id="eventlist">
            <section class="page">
                <div id="topnav" class="topnav">
                    <label class="toppad" id="1" onclick="filterlocation(this.id);">Karaoke</label>
                    <label class="toppad" id="2" onclick="filterlocation(this.id);">Happy Hours</label>
                    <label class="toppad" id="3" onclick="filterlocation(this.id);">Ladies Nights</label>
                    <label class="toppad" id="4" onclick="filterlocation(this.id);">Special Offers</label>
                    <label class="toppad" id="5" onclick="filterlocation(this.id);">Special Events</label>
                </div>
                <div id="tabnav" class="tabnav">
                    <label onclick="today_list();" class="tabpad">TODAY</label>
                    <label onclick="tomorrow_list();" class="tabpad">TOMMOROW</label>
                    <label onclick="calendarview();">CALENDAR</label>
                </div>
                <div id="map-canvas" class="mapdisp"></div>
                <div id="listview" class="container" style="margin-top: 29px;"></div>
                <div id="calendarview" class="container" style="margin-top: 5%;"></div>
                </div>
                <div id="bottomnav" class="bottomnav">
                    <div class="firstnav"><label onclick="displaymapview();">MAP VIEW</label></div>
                    <div class="firstnav"><label onclick="displaylistview();">LIST VIEW</label></div>
                </div>
            </section>
            <input type="hidden" id="location" name="location">
            <input type="hidden" id="latitute" name="latitute">
            <input type="hidden" id="longitute" name="longitute">
            <input type="hidden" id="filter_id" name="filter_id">
            <script src="https://maps.googleapis.com/maps/api/js?v=3&sensor=false" type="text/javascript"></script>
            <script type="text/javascript">
            var list;

                function goto_register(){
                  $('#login').hide();
                  $('#register').show();
                }

                function go_to_login(){
                  $('#register').hide();
                  $('#login').show();
                }

                function validateEmail(email){
                var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;

                    if (reg.test(email.value) == false) {
                        alert('Invalid Email Address');
                        return false;
                    } return true; 
                }   

                function login(){
                    var email = document.getElementById('email').value;
                    var password = document.getElementById('password').value;
                    var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;

                    if(reg.test(email) != false && password != null){
                        $.ajax({
                           url:'http://casaestilo.in/mparties/index.php/api/login_user/',
                            type: 'post',
                            data: {
                                username: email,
                                password: password,
                            },
                            success: function(data){                        
                                $.each(data, function(index, value){
                                    if (value.id == 0){
                                        alert('Please check the username/password you have entered')
                                    } else {
                                        // get_user(value.id);
                                        $("#searchlocation").show();
                                        $("#login").hide();
                                    }
                                })
                            }
                        })
                    } else { alert('Fill all the fields properly.') }
                }

                function submit_data(){
                    var fname = document.getElementById('fname').value;
                    var email = document.getElementById('newemail').value;
                    var password = document.getElementById('newpassword').value;
                    var cpassword = document.getElementById('newcpassword').value;
                    var tel = document.getElementById('tel').value;
                    var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;

                    if(reg.test(email) != false && fname != null && password != null && tel != null){
                        if(password == cpassword){
                            $.ajax({
                               url:'http://casaestilo.in/mparties/index.php/api/register_user/',
                                type: 'post',
                                data: {
                                    email: email,
                                    password: password,
                                    fname: fname,
                                    tel: tel
                                },
                                success: function(data){
                                  // get_user(data.user_id);
                                }
                            })
                        } else { alert('Confirm Password does not match') }
                    } else { alert('Fill all the fields') }
                }

            function loadsearch(){
                $("#location").val(0);
                $.ajax({
                    url:'http://casaestilo.in/mparties/index.php/api/get_Event_palce/',
                    type: 'post',
                    crossDomain:true,
                    success: function(data){
                        $('#divlocation').ddslick({
                            data: data,
                            selectText: "Select your location",
                            onSelected: function(data){
                                $.each(data.selectedData, function(index, value){
                                    $("#location").val(value);
                                })
                            } 
                        });
                    }
                })
            }

            function loadsearchopt(){
                $("#location").val(0);
                $.ajax({
                    url:'http://casaestilo.in/mparties/index.php/api/get_Event_palce/',
                    type: 'post',
                    crossDomain:true,
                    success: function(data){
                        $('#searchopt').ddslick({
                            data: data,
                            selectText: "Select your location",
                            onSelected: function(data){
                                $.each(data.selectedData, function(index, value){
                                    $("#location").val(value);
                                })
                            } 
                        });
                    }
                })
            }

            function go_to_search(){
                $('#map-canvas').empty();
                $('#listview').empty();
                $("#header").hide();
                $("#bottomnav").hide();
                $("#register").hide();
                $("#eventlist").hide();
                $("#listview").hide();
                $("#calendarview").hide();
                $("#searchlocation").show();
            }

            function filterlocation(id){
                var location = $("#location").val();
                $('#map-canvas').empty();
                $('#listview').empty();
                $('#filter_id').val(id);
                load_event_list();
            }

            function load_event_list(){
                var id = $("#location").val();
                if (id == 0) {
                    alert('Select Option.');
                } else {
                    $('#searchlocation').hide();
                    $('#map-canvas').empty();
                    $('#listview').empty();
                    $("#calendarview").hide();
                    $('#eventlist').show();
                    $("#bottomnav").show();
                    $.ajax({
                        url: 'http://casaestilo.in/mparties/index.php/api/getlatlog',
                        type: 'post',
                        crossDomain:true,
                        data: {
                            id: id
                        },
                        crossDomain: true,
                        success: function(data){
                            $.each(data, function(index, value){
                                $("#latitute").val(value.latitude);
                                $("#longitute").val(value.longitude);
                            })
                        initialize(id);
                        }
                    })
                }
            }

                var map;
                var image = 'img/pearl1.png';
                var infowindow = new google.maps.InfoWindow();
                var marker, i;

                function initialize(id){
                    $("#header").show();
                    var lat = $("#latitute").val();
                    var lon = $("#longitute").val();
                    map = new google.maps.Map(document.getElementById('map-canvas'), {
                        zoom: 13,
                            center: new google.maps.LatLng(lat, lon),
                    });

                    $.ajax({
                        url:'http://casaestilo.in/mparties/index.php/api/get_entities_list/',
                        type: 'post',
                        crossDomain:true,
                        data: {
                            id : id
                        },
                        success: function(data){
                            console.log(data);
                            list = data;
                            // displaylist(data);
                            $.each(data, function(index, value){
                                var v = value.latitude;
                                var s = value.longitude;
                                console.log(v+' '+s);
                                marker = new google.maps.Marker({
                                    position: new google.maps.LatLng(v, s),
                                    map: map,
                                    icon: image                                
                                })
                            })
                            $("#map-canvas").show();
                        }
                    })

                    google.maps.event.addListener(marker, 'click', (function(marker, i) {
                        return function() {
                            redirecttogoogle();
                        }
                    })(marker));
                }

                function redirecttogoogle(){
                    window.location = "http://www.google.com";
                }

                function displaylist(data){
                    $.each(list, function(index, value){
                        var mainlist = $(document.createElement('div'))
                        mainlist.attr('class', 'listitem row')
                        var subdiv = $(document.createElement('div'))
                        subdiv.attr('class', 'col-xs-6');
                        var subdi = $(document.createElement('div'))
                        subdi.attr('class', 'col-xs-6');
                        var img = "http://casaestilo.in/mparties/assets/uploads/"+value.image;
                        var title = $(document.createElement('h1')).html(value.entity_name)
                        var rating = $(document.createElement('p')).html("Rating : "+value.rating)
                        var category = $(document.createElement('p')).html("Category : "+value.category)
                        var image = $("<img>")
                        image.attr('src', img)
                        image.attr('class', 'img-responsive')
                        $('#listview').append(mainlist.append(subdiv.append(image)).append(subdi.append(title).append(rating).append(category)));
                    })
                }

                function tomorrow_list(){
                    var locationid = $("#location").val();
                    console.log(locationid);
                    $.ajax({
                        url: 'http://casaestilo.in/mparties/index.php/api/get_tommorow_list/',
                        type: 'post',
                        crossDomain:true,
                        data: {
                            id: locationid
                        },
                        crossDomain: true,
                        success: function(data){
                            var todaydata = data;
                            $("#listview").empty();
                            $.each(data, function(index, value){
                                if(value.id == 0){
                                    var txt = $(document.createElement('h1')).html('There are no events available for today check for other venues or other location.');
                                    txt.attr('style', 'margin-top: 20%');
                                    $("#listview").append(txt);
                                } else {
                                    displaylist(todaydata);
                                }
                            })
                        }
                    })

                }

                function today_list(){
                    var locationid = $("#location").val();
                    console.log(locationid);
                    $.ajax({
                        url: 'http://casaestilo.in/mparties/index.php/api/get_today_list/',
                        type: 'post',
                        crossDomain:true,
                        data: {
                            id: locationid
                        },
                        crossDomain: true,
                        success: function(data){
                            var todaydata = data;
                            $("#listview").empty();
                            $.each(data, function(index, value){
                                if(value.id == 0){
                                    var txt = $(document.createElement('h1')).html('There are no events available for today check for other venues or other location.');
                                    txt.attr('style', 'margin-top: 20%');
                                    $("#listview").append(txt);
                                } else {
                                    displaylist(todaydata);
                                }
                            })
                        }
                    })
                }

                function calendarview(){
                    $("#listview").hide();
                    $("#calendarview").show();
                    theMonths = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                    theDays = ["S", "M", "T", "W", "T", "F", "S"];

                    $('#calendarview').calendar({
                        months: theMonths,
                        days: theDays,
                        req_ajax: {
                            type: 'post',
                            url: 'http://casaestilo.in/mparties/index.php/api/calendar_view/1'
                        }
                    });
                }
            </script>
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/scripts.js"></script>
        
        <script type="text/javascript">
            $('div[data-include]').each(function() {
                $(this).load( $(this).attr('data-include') + '.html').trigger('create');
            });
        </script>

        <script type="text/javascript" src="https://dl.dropboxusercontent.com/u/40036711/Scripts/jquery.ddslick.min.js"></script>
        <script src="http://lab.xero.nu/bootstrap_calendar/lib/js/bootstrap_calendar.min.js"></script>

        <script type="text/javascript">
                $(document).ready(function() {
                    $("#header").hide();
                    $("#bottomnav").hide();
                    $("#register").hide();
                    $("#searchlocation").hide();                
                    $("#eventlist").hide();
                    $("#listview").hide();
                    $("#calendarview").hide();
                    loadsearch();
                    loadsearchopt();
                });

            function displaymapview(){
                $("#tabnav").hide();
                $("#topnav").show();
                $("#listview").hide();
                $("#map-canvas").show();
                $("#calendarview").hide();
            }

            function displaylistview(){
                $("#calendarview").hide();
                $("#topnav").hide();
                $("#map-canvas").hide();
                $("#tabnav").show();
                $("#listview").show();
                $("#listview").empty();
                var data = list;
                displaylist(data);
            }
        </script>
    </body>
</html>
